<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
   <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

    <title>Survey</title>
  </head>
  <body>
    <style>
        body {
            background-color: lightslategray;
            }
        
        #jumbo{
            background-color: antiquewhite;
            }
        .question{
            color: white;
            font-size: 24px;
            }
        </style>
    <div class="container">
        <div class="jumbotron row" id="jumbo">

            <div class="container content">
                <h1>Survey</h1>
                <hr>
                <p>Take a survey to find your match!</p>
                 <!-- Modal after survey completion -->
                 <div id="friendModal" class="modal fade animated slideInRight delay-2s" role="dialog">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3 class="modal-title">Your New Best Friend</h3>
                            </div>
                            <div class="modal-body">
                                <h2 id="friend"></h2>
                                <img id="friendPhoto" src="#">
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--------------------------------------->
             <!-- Modal after survey completion -->
             <div id="addFriendModal" class="modal fade animated slideInLeft" role="dialog">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="modal-title">New Friend was added.</h3>
                        </div>
                        <div class="modal-body">
                            <h2 id="addFriend"></h2>
                            <img id="addFriendPhoto" src="#">
                        </div>      
                    </div>
                </div>
            </div>
        </div>
        <!--------------------------------------->

                <form>
                    <div class="form-group row">
                        <input id="name" type="text" class="form-control w-50" placeholder="Name">
                    </div>
                    <div class="form-group row">
                        <input id="photo" type="text" class="form-control w-50" placeholder="Link to Profile Photo">
                    </div>
                    <div class="form-group row animated flipInY">
                        <select class="col-md-3 custom-select" id="q1">
                            <option selected></option>
                            <option value="1">Strongly Disagree</option>
                            <option value="2">Disagree</option>
                            <option value="3">Okay with it</option>
                            <option value="4">Agree</option>
                            <option value="5">Strongly Agree</option>
                        </select>
                        <label class="col-md-9"><p class="question">Final Fantasy 7 Remake is the best game of the year!</p></label>
                    </div>
                    <div class="form-group row animated flipInX">
                        <select class="col-md-3 custom-select" id="q2">
                            <option selected></option>
                            <option value="1">Strongly Disagree</option>
                            <option value="2">Disagree</option>
                            <option value="3">Okay with it</option>
                            <option value="4">Agree</option>
                            <option value="5">Strongly Agree</option>
                        </select>
                            <label class="col-md-9"><p class="question">I call Thursday mini Friday.</p></label>
                    </div>
                    <div class="form-group row animated flipInY delay-1s">
                        <select class="col-md-3 custom-select" id="q3">
                            <option selected></option>
                            <option value="1">Strongly Disagree</option>
                            <option value="2">Disagree</option>
                            <option value="3">Okay with it</option>
                            <option value="4">Agree</option>
                            <option value="5">Strongly Agree</option>
                        </select>
                            <label class="col-md-9"><p class="question">I like working out everyday.</p></label>
                    </div>
                    <div class="form-group row animated flipInX delay-1s">
                        <select class="col-md-3 custom-select" id="q4">
                            <option selected></option>
                            <option value="1">Strongly Disagree</option>
                            <option value="2">Disagree</option>
                            <option value="3">Okay with it</option>
                            <option value="4">Agree</option>
                            <option value="5">Strongly Agree</option>
                        </select>
                            <label class="col-md-9"><p class="question">I think I am the hottest person in the world.</p></label>
                    </div>
                    <div class="form-group row animated flipInY delay-2s">
                        <select class="col-md-3 custom-select" id="q5">
                            <option selected></option>
                            <option value="1">Strongly Disagree</option>
                            <option value="2">Disagree</option>
                            <option value="3">Okay with it</option>
                            <option value="4">Agree</option>
                            <option value="5">Strongly Agree</option>
                        </select>
                            <label class="col-md-9"><p class="question">I use Bootstrap for every website I code.</p></label>
                    </div>
                    <div class="form-group row animated flipInX delay-2s">
                        <select class="col-md-3 custom-select" id="q6">
                            <option selected></option>
                            <option value="1">Strongly Disagree</option>
                            <option value="2">Disagree</option>
                            <option value="3">Okay with it</option>
                            <option value="4">Agree</option>
                            <option value="5">Strongly Agree</option>
                        </select>
                            <label class="col-md-9"><p class="question">Money can buy anything you want.</p></label>
                    </div>
                    <div class="form-group row animated flipInY delay-3s">
                        <select class="col-md-3 custom-select" id="q7">
                            <option selected></option>
                            <option value="1">Strongly Disagree</option>
                            <option value="2">Disagree</option>
                            <option value="3">Okay with it</option>
                            <option value="4">Agree</option>
                            <option value="5">Strongly Agree</option>
                        </select>
                            <label class="col-md-9"><p class="question">The more I learn the more I find out how much I don't know.</p></label>
                    </div>
                    <div class="form-group row animated flipInX delay-3s">
                        <select class="col-md-3 custom-select" id="q8">
                            <option selected></option>
                            <option value="1">Strongly Disagree</option>
                            <option value="2">Disagree</option>
                            <option value="3">Okay with it</option>
                            <option value="4">Agree</option>
                            <option value="5">Strongly Agree</option>
                        </select>
                            <label class="col-md-9"><p class="question">I enjoy 1 hour stuck in traffic.</p></label>
                    </div>
                    <div class="form-group row animated flipInY delay-4s">
                        <select class="col-md-3 custom-select" id="q9">
                            <option selected></option>
                            <option value="1">Strongly Disagree</option>
                            <option value="2">Disagree</option>
                            <option value="3">Okay with it</option>
                            <option value="4">Agree</option>
                            <option value="5">Strongly Agree</option>
                        </select>
                            <label class="col-md-9"><p class="question">I enjoy watching amime.</p></label>
                    </div>
                    <div class="form-group row animated flipInX delay-4s">
                        <select class="col-md-3 custom-select" id="q10">
                            <option selected></option>
                            <option value="1">Strongly Disagree</option>
                            <option value="2">Disagree</option>
                            <option value="3">Okay with it</option>
                            <option value="4">Agree</option>
                            <option value="5">Strongly Agree</option>
                        </select>
                            <label class="col-md-9"><p class="question">Playstation is better then Xbox!</p></label>
                    </div>
                </form>
                <div class="text-center">
                    <button id="sub" type="submit" class="btn btn-success btn-lg">Submit</button>
                </div>
                
            <footer>
                <div class="container">
                    <a href="/api/friends">API Friends Link </a><span>||
                    <a href="/">Home Link</a>
                    </span>
                </div>
            </footer>

            <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
            <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
          </body>
        </html>


<script type="text/javascript">
        
$("#sub").on("click", function(event) {
event.preventDefault();
var newFriend = {
                name: $("#name").val().trim(),
                photo: $("#photo").val().trim(),
                score: [
                        parseInt($("#q1").val()),
                        parseInt($("#q2").val()),
                        parseInt($("#q3").val()),
                        parseInt($("#q4").val()),
                        parseInt($("#q5").val()),
                        parseInt($("#q6").val()),
                        parseInt($("#q7").val()),
                        parseInt($("#q8").val()),
                        parseInt($("#q9").val()),
                        parseInt($("#q10").val())
                        ]
                };
console.log(newFriend);

$.ajax({ url: "/api/friends", method: "GET" })
      .then(function(data) {

    console.log(data);
    var pick = 0;
    var min = 40;
    
    for(var i = 0; i < data.length; i++){
        var total = 0;
        for(var j = 0; j < data[i].score.length; j++){
            var diff = Math.abs(newFriend.score[j] - data[i].score[j]);
            total += diff;
        }
        if (total < min){
            pick = i;
            min = total;
        }
    }
    console.log(pick);
    $("#friend").text(data[pick].name);
	$("#friendPhoto").attr("src", data[pick].photo);
    $("#friendModal").modal("toggle");

}).then(function(){
    $.post("/api/friends", newFriend)
    .done(function(){
    
    $("#addFriend").text(newFriend.name);
	$("#addFriendPhoto").attr("src", newFriend.photo);
    $("#addFriendModal").modal("toggle");
    setTimeout(function(){
        $("#addFriendModal").modal("hide");
    }, 2000);
});
});
				
});
          
</script>